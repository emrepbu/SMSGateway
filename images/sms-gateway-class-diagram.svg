<svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <!-- Styles and definitions -->
  <defs>
    <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#4776E6" />
      <stop offset="100%" stop-color="#8E54E9" />
    </linearGradient>
    <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="rgba(0,0,0,0.3)" />
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#555" />
    </marker>
  </defs>

  <!-- Page title -->
  <rect x="10" y="10" width="780" height="50" rx="10" fill="url(#headerGradient)" filter="url(#dropShadow)" />
  <text x="400" y="42" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="white" text-anchor="middle">SMS Gateway Component Interaction</text>

  <!-- SmsGatewayApp -->
  <rect x="300" y="70" width="200" height="80" rx="5" fill="#e1f5fe" stroke="#0277bd" stroke-width="2" filter="url(#dropShadow)" />
  <text x="400" y="100" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#01579b" text-anchor="middle">SmsGatewayApp</text>
  <line x1="310" y1="110" x2="490" y2="110" stroke="#0277bd" stroke-width="1" />
  <text x="400" y="130" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">Application initialization</text>
  
  <!-- SmsReceiver -->
  <rect x="50" y="200" width="160" height="100" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" filter="url(#dropShadow)" />
  <text x="130" y="230" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1b5e20" text-anchor="middle">SmsReceiver</text>
  <line x1="60" y1="240" x2="200" y2="240" stroke="#2e7d32" stroke-width="1" />
  <text x="130" y="260" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">onReceive()</text>
  <text x="130" y="280" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">notifySmsReceived()</text>
  
  <!-- WorkManager / SmsWorkManager -->
  <rect x="50" y="350" width="160" height="100" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" filter="url(#dropShadow)" />
  <text x="130" y="380" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1b5e20" text-anchor="middle">SmsWorkManager</text>
  <line x1="60" y1="390" x2="200" y2="390" stroke="#2e7d32" stroke-width="1" />
  <text x="130" y="410" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">scheduleSmsCheckWork()</text>
  <text x="130" y="430" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">enqueue(ProcessSmsWorker)</text>
  
  <!-- ProcessSmsWorker -->
  <rect x="250" y="200" width="160" height="120" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" filter="url(#dropShadow)" />
  <text x="330" y="230" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1b5e20" text-anchor="middle">ProcessSmsWorker</text>
  <line x1="260" y1="240" x2="400" y2="240" stroke="#2e7d32" stroke-width="1" />
  <text x="330" y="260" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">doWork()</text>
  <text x="330" y="280" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">smsRepository</text>
  <text x="330" y="300" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">processNewSmsUseCase</text>
  
  <!-- SmsRepository -->
  <rect x="250" y="350" width="160" height="140" rx="5" fill="#ffebee" stroke="#c62828" stroke-width="2" filter="url(#dropShadow)" />
  <text x="330" y="380" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#b71c1c" text-anchor="middle">SmsRepository</text>
  <line x1="260" y1="390" x2="400" y2="390" stroke="#c62828" stroke-width="1" />
  <text x="330" y="410" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">insertMessage()</text>
  <text x="330" y="430" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">getUnforwardedMessages()</text>
  <text x="330" y="450" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">updateSmsForwardStatus()</text>
  <text x="330" y="470" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">refreshSmsFromSystem()</text>
  
  <!-- ProcessNewSmsUseCase -->
  <rect x="450" y="200" width="180" height="120" rx="5" fill="#fff3e0" stroke="#e65100" stroke-width="2" filter="url(#dropShadow)" />
  <text x="540" y="230" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#bf360c" text-anchor="middle">ProcessNewSmsUseCase</text>
  <line x1="460" y1="240" x2="620" y2="240" stroke="#e65100" stroke-width="1" />
  <text x="540" y="260" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">invoke(SmsMessage)</text>
  <text x="540" y="280" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">filterRuleRepository</text>
  <text x="540" y="300" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">applyFilterUseCase</text>
  
  <!-- ApplyFilterUseCase -->
  <rect x="450" y="350" width="180" height="100" rx="5" fill="#fff3e0" stroke="#e65100" stroke-width="2" filter="url(#dropShadow)" />
  <text x="540" y="380" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#bf360c" text-anchor="middle">ApplyFilterUseCase</text>
  <line x1="460" y1="390" x2="620" y2="390" stroke="#e65100" stroke-width="1" />
  <text x="540" y="410" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">invoke(SmsMessage, List<Rule>)</text>
  <text x="540" y="430" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">returns: List<RuleMatch></text>
  
  <!-- FilterRuleRepository -->
  <rect x="450" y="480" width="180" height="100" rx="5" fill="#ffebee" stroke="#c62828" stroke-width="2" filter="url(#dropShadow)" />
  <text x="540" y="510" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#b71c1c" text-anchor="middle">FilterRuleRepository</text>
  <line x1="460" y1="520" x2="620" y2="520" stroke="#c62828" stroke-width="1" />
  <text x="540" y="540" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">getEnabledFilterRules()</text>
  <text x="540" y="560" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">saveFilterRule()</text>
  
  <!-- SendEmailForSmsUseCase -->
  <rect x="650" y="200" width="180" height="100" rx="5" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" filter="url(#dropShadow)" />
  <text x="740" y="230" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#4a148c" text-anchor="middle">SendEmailForSmsUseCase</text>
  <line x1="660" y1="240" x2="820" y2="240" stroke="#7b1fa2" stroke-width="1" />
  <text x="740" y="260" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">invoke(Sms, List<String>)</text>
  <text x="740" y="280" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">returns: Result<Unit></text>
  
  <!-- SmsMessage -->
  <rect x="650" y="350" width="180" height="120" rx="5" fill="#e1f5fe" stroke="#0277bd" stroke-width="2" filter="url(#dropShadow)" />
  <text x="740" y="380" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#01579b" text-anchor="middle">SmsMessage</text>
  <line x1="660" y1="390" x2="820" y2="390" stroke="#0277bd" stroke-width="1" />
  <text x="740" y="410" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">id, sender, message</text>
  <text x="740" y="430" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">timestamp, isRead</text>
  <text x="740" y="450" font-family="Arial, sans-serif" font-size="12" fill="#333" text-anchor="middle">type, isForwarded</text>
  
  <!-- Connection Lines with Labels -->
  <!-- App to SmsReceiver -->
  <line x1="350" y1="150" x2="130" y2="200" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="220" y="180" font-family="Arial, sans-serif" font-size="10" fill="#555">registers</text>
  
  <!-- App to WorkManager -->
  <line x1="380" y1="150" x2="130" y2="350" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="200" y="250" font-family="Arial, sans-serif" font-size="10" fill="#555">initializes</text>
  
  <!-- SmsReceiver to ProcessSmsWorker -->
  <line x1="210" y1="250" x2="250" y2="250" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="230" y="240" font-family="Arial, sans-serif" font-size="10" fill="#555">enqueues</text>
  
  <!-- WorkManager to ProcessSmsWorker -->
  <line x1="130" y1="350" x2="300" y2="320" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="200" y="330" font-family="Arial, sans-serif" font-size="10" fill="#555">executes</text>
  
  <!-- ProcessSmsWorker to SmsRepository -->
  <line x1="330" y1="320" x2="330" y2="350" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="340" y="340" font-family="Arial, sans-serif" font-size="10" fill="#555">stores</text>
  
  <!-- ProcessSmsWorker to ProcessNewSmsUseCase -->
  <line x1="410" y1="250" x2="450" y2="250" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="430" y="240" font-family="Arial, sans-serif" font-size="10" fill="#555">calls</text>
  
  <!-- ProcessNewSmsUseCase to ApplyFilterUseCase -->
  <line x1="540" y1="320" x2="540" y2="350" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="550" y="340" font-family="Arial, sans-serif" font-size="10" fill="#555">uses</text>
  
  <!-- ProcessNewSmsUseCase to FilterRuleRepository -->
  <line x1="500" y1="320" x2="500" y2="480" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="510" y="400" font-family="Arial, sans-serif" font-size="10" fill="#555">queries rules</text>
  
  <!-- ProcessNewSmsUseCase to SendEmailForSmsUseCase -->
  <line x1="630" y1="250" x2="650" y2="250" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="640" y="240" font-family="Arial, sans-serif" font-size="10" fill="#555">forwards</text>
  
  <!-- ProcessSmsWorker to SmsMessage -->
  <line x1="410" y1="260" x2="650" y2="360" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="540" y="300" font-family="Arial, sans-serif" font-size="10" fill="#555">creates</text>
  
  <!-- Repository to Data Classes -->
  <line x1="350" y1="490" x2="450" y2="530" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="390" y="500" font-family="Arial, sans-serif" font-size="10" fill="#555">manages</text>
  
  <!-- Legend -->
  <rect x="50" y="500" width="320" height="80" rx="5" fill="white" stroke="#ccc" stroke-width="1" filter="url(#dropShadow)" />
  <text x="60" y="520" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">Legend:</text>
  
  <rect x="60" y="530" width="20" height="20" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1" />
  <text x="90" y="545" font-family="Arial, sans-serif" font-size="12" fill="#333">Core Components (SMS Processing)</text>
  
  <rect x="60" y="560" width="20" height="20" fill="#ffebee" stroke="#c62828" stroke-width="1" />
  <text x="90" y="575" font-family="Arial, sans-serif" font-size="12" fill="#333">Data Access (Repositories)</text>
  
  <rect x="250" y="530" width="20" height="20" fill="#fff3e0" stroke="#e65100" stroke-width="1" />
  <text x="280" y="545" font-family="Arial, sans-serif" font-size="12" fill="#333">Business Logic (Use Cases)</text>
  
  <rect x="250" y="560" width="20" height="20" fill="#e1f5fe" stroke="#0277bd" stroke-width="1" />
  <text x="280" y="575" font-family="Arial, sans-serif" font-size="12" fill="#333">Models & Application</text>