<svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <!-- Styles and definitions -->
  <defs>
    <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" stop-color="#4776E6" />
      <stop offset="100%" stop-color="#8E54E9" />
    </linearGradient>
    <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="rgba(0,0,0,0.3)" />
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#555" />
    </marker>
  </defs>

  <!-- Page title -->
  <rect x="10" y="10" width="780" height="50" rx="10" fill="url(#headerGradient)" filter="url(#dropShadow)" />
  <text x="400" y="42" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="white" text-anchor="middle">SMS Gateway Sequence Diagram</text>

  <!-- Actors and Components -->
  <rect x="50" y="80" width="100" height="40" rx="5" fill="#e3f2fd" stroke="#0d47a1" stroke-width="2" filter="url(#dropShadow)" />
  <text x="100" y="105" font-family="Arial, sans-serif" font-size="14" fill="#0d47a1" text-anchor="middle">Android OS</text>
  
  <rect x="170" y="80" width="100" height="40" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" filter="url(#dropShadow)" />
  <text x="220" y="105" font-family="Arial, sans-serif" font-size="14" fill="#2e7d32" text-anchor="middle">SmsReceiver</text>
  
  <rect x="290" y="80" width="100" height="40" rx="5" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" filter="url(#dropShadow)" />
  <text x="340" y="105" font-family="Arial, sans-serif" font-size="14" fill="#2e7d32" text-anchor="middle">WorkManager</text>
  
  <rect x="410" y="80" width="100" height="40" rx="5" fill="#fff3e0" stroke="#e65100" stroke-width="2" filter="url(#dropShadow)" />
  <text x="460" y="105" font-family="Arial, sans-serif" font-size="14" fill="#e65100" text-anchor="middle">ProcessSms Worker</text>
  
  <rect x="530" y="80" width="100" height="40" rx="5" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" filter="url(#dropShadow)" />
  <text x="580" y="105" font-family="Arial, sans-serif" font-size="14" fill="#7b1fa2" text-anchor="middle">Repository</text>
  
  <rect x="650" y="80" width="100" height="40" rx="5" fill="#ffebee" stroke="#c62828" stroke-width="2" filter="url(#dropShadow)" />
  <text x="700" y="105" font-family="Arial, sans-serif" font-size="14" fill="#c62828" text-anchor="middle">Use Cases</text>

  <!-- Lifelines -->
  <line x1="100" y1="120" x2="100" y2="550" stroke="#0d47a1" stroke-width="1" stroke-dasharray="5,5" />
  <line x1="220" y1="120" x2="220" y2="550" stroke="#2e7d32" stroke-width="1" stroke-dasharray="5,5" />
  <line x1="340" y1="120" x2="340" y2="550" stroke="#2e7d32" stroke-width="1" stroke-dasharray="5,5" />
  <line x1="460" y1="120" x2="460" y2="550" stroke="#e65100" stroke-width="1" stroke-dasharray="5,5" />
  <line x1="580" y1="120" x2="580" y2="550" stroke="#7b1fa2" stroke-width="1" stroke-dasharray="5,5" />
  <line x1="700" y1="120" x2="700" y2="550" stroke="#c62828" stroke-width="1" stroke-dasharray="5,5" />

  <!-- Activation boxes -->
  <rect x="95" y="150" width="10" height="40" fill="#0d47a1" />
  <rect x="215" y="150" width="10" height="80" fill="#2e7d32" />
  <rect x="335" y="190" width="10" height="80" fill="#2e7d32" />
  <rect x="455" y="230" width="10" height="240" fill="#e65100" />
  <rect x="575" y="270" width="10" height="60" fill="#7b1fa2" />
  <rect x="695" y="350" width="10" height="100" fill="#c62828" />
  <rect x="575" y="430" width="10" height="40" fill="#7b1fa2" />

  <!-- Message 1: SMS Broadcast -->
  <line x1="105" y1="150" x2="215" y2="150" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="160" y="140" font-family="Arial, sans-serif" font-size="12" fill="#555">1. SMS_RECEIVED_ACTION</text>
  
  <!-- Message 2: Create Work Request -->
  <line x1="225" y1="190" x2="335" y2="190" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="280" y="180" font-family="Arial, sans-serif" font-size="12" fill="#555">2. enqueue(processWorkRequest)</text>
  
  <!-- Message 3: Execute Worker -->
  <line x1="345" y1="230" x2="455" y2="230" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="400" y="220" font-family="Arial, sans-serif" font-size="12" fill="#555">3. doWork()</text>
  
  <!-- Message 4: Store SMS -->
  <line x1="465" y1="270" x2="575" y2="270" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="520" y="260" font-family="Arial, sans-serif" font-size="12" fill="#555">4. insertMessage(sms)</text>
  
  <!-- Message 5: Return success -->
  <line x1="575" y1="330" x2="465" y2="330" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="520" y="320" font-family="Arial, sans-serif" font-size="12" fill="#555">5. success</text>
  
  <!-- Message 6: Process SMS -->
  <line x1="465" y1="350" x2="695" y2="350" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="580" y="340" font-family="Arial, sans-serif" font-size="12" fill="#555">6. processNewSmsUseCase(sms)</text>
  
  <!-- Message 7: Apply filters -->
  <path d="M705 370 L720 370 L720 390 L705 390" stroke="#555" stroke-width="1.5" fill="none" marker-end="url(#arrowhead)" />
  <text x="730" y="380" font-family="Arial, sans-serif" font-size="12" fill="#555">7. applyFilterUseCase()</text>
  
  <!-- Message 8: Send email -->
  <path d="M705 410 L720 410 L720 430 L705 430" stroke="#555" stroke-width="1.5" fill="none" marker-end="url(#arrowhead)" />
  <text x="730" y="420" font-family="Arial, sans-serif" font-size="12" fill="#555">8. sendEmailForSmsUseCase()</text>
  
  <!-- Message 9: Return forwarding result -->
  <line x1="695" y1="450" x2="465" y2="450" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="580" y="440" font-family="Arial, sans-serif" font-size="12" fill="#555">9. ForwardResult</text>
  
  <!-- Message 10: Update status -->
  <line x1="465" y1="470" x2="575" y2="470" stroke="#555" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="520" y="460" font-family="Arial, sans-serif" font-size="12" fill="#555">10. updateSmsForwardStatus(id, true)</text>
  
  <!-- Notes -->
  <rect x="20" y="520" width="760" height="60" rx="5" fill="#f5f5f5" stroke="#ccc" stroke-width="1" />
  <text x="30" y="540" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">Key Points:</text>
  <text x="30" y="560" font-family="Arial, sans-serif" font-size="12" fill="#333">- SMS processing happens in background using WorkManager for reliability even if the app is killed</text>
  <text x="30" y="575" font-family="Arial, sans-serif" font-size="12" fill="#333">- Clean architecture separates concerns: UI, business logic, and data access are isolated with clear boundaries</text>
</svg>